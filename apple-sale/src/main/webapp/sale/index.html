<!DOCTYPE html>
<html lang="zh">
<head>
<title>aStar</title>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="description" content="aStar Fashion Template Project">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css"
	href="styles/bootstrap-4.1.3/bootstrap.css">
<link href="plugins/font-awesome-4.7.0/css/font-awesome.min.css"
	rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css"
	href="plugins/OwlCarousel2-2.2.1/owl.carousel.css">
<link rel="stylesheet" type="text/css"
	href="plugins/OwlCarousel2-2.2.1/owl.theme.default.css">
<link rel="stylesheet" type="text/css"
	href="plugins/OwlCarousel2-2.2.1/animate.css">
<link rel="stylesheet" type="text/css" href="styles/main_styles.css">
<link rel="stylesheet" type="text/css" href="styles/responsive.css">
<script src="js/jquery-3.2.1.min.js"></script>

<style type="text/css">

	.shopcar_div{
		background-color: red;
		width: 50px;
		height: 50px;
		position: absolute;
		z-index: 20;
	}


</style>

</head>
<body>

	<div class="super_container">

		<div id="dd_div">
			<!--异步加载其他文件-->
			<script>
				$("#dd_div").load("sidebar.jsp");
			</script>

		</div>

		<div class="home">
			<!-- 图片轮播 -->
			<div class="home_slider_container">
				<div class="owl-carousel owl-theme home_slider">

					<!-- Slide -->
					<div class="owl-item">
						<div class="background_image"
							style="background-image: url(images/home_slider_1.jpg)"></div>
						<div class="home_content_container">
							<div class="home_content">
								<div
									class="home_discount d-flex flex-row align-items-end justify-content-start">
									<div class="home_discount_num">20</div>
									<div class="home_discount_text">最高折扣</div>
								</div>
								<!--<div class="home_title">秋季新品</div>-->
							</div>
						</div>
					</div>

					<!-- Slide -->
					<div class="owl-item">
						<div class="background_image"
							style="background-image: url(images/home_slider_1.jpg)"></div>
						<div class="home_content_container">
							<div class="home_content">
								<div
									class="home_discount d-flex flex-row align-items-end justify-content-start">
									<div class="home_discount_num">20</div>
									<div class="home_discount_text">最高折扣</div>
								</div>
								<!--<div class="home_title">秋季新品</div>-->
							</div>
						</div>
					</div>

					<!-- Slide -->
					<div class="owl-item">
						<div class="background_image"
							style="background-image: url(images/home_slider_1.jpg)"></div>
						<div class="home_content_container">
							<div class="home_content">
								<div
									class="home_discount d-flex flex-row align-items-end justify-content-start">
									<div class="home_discount_num">20</div>
									<div class="home_discount_text">最高折扣</div>
								</div>
								<!--<div class="home_title">秋季新品</div>-->
							</div>
						</div>
					</div>

				</div>

				<!-- Home Slider Navigation -->
				<div class="home_slider_nav home_slider_prev trans_200">
					<div
						class=" d-flex flex-column align-items-center justify-content-center">
						<img src="images/prev.png" alt="">
					</div>
				</div>
				<div class="home_slider_nav home_slider_next trans_200">
					<div
						class=" d-flex flex-column align-items-center justify-content-center">
						<img src="images/next.png" alt="">
					</div>
				</div>

			</div>
		</div>

		<!-- Boxes -->
		<div class="boxes">
			<div class="section_container">
				<div class="container">
					<div class="row" id="type_div">

						<!--就是展示商品类别列表-->
					</div>
				</div>
			</div>
		</div>

		<!-- Categories -->

		<div class="categories">
			<div class="section_container">
				<div class="container">
					<div class="row">
						<div class="col text-center">
							<div class="categories_list_container">
								<ul
									class="categories_list d-flex flex-row align-items-center justify-content-start">
									<li><a href="javascript:;" onclick="queryByGLabel(1)">新款上市</a></li>
									<li><a href="javascript:;" onclick="queryByGLabel(3)">劲爆折扣</a></li>
									<li><a href="javascript:;" onclick="queryByGLabel(2)">爆款为你</a></li>
								</ul>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<!-- Products -->
		<div class="products">
			<div class="section_container">
				<div class="container">
					<div class="row">
						<div class="col">
							<div class="products_container" id="goodlist_div" style="display: flex;flex-wrap: wrap ">
                                <!--循环展示首页商品信息-->

							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<script src="js/shopcar.js"></script>
	<script src="styles/bootstrap-4.1.3/popper.js"></script>
	<script src="styles/bootstrap-4.1.3/bootstrap.min.js"></script>
	<script src="plugins/greensock/TweenMax.min.js"></script>
	<script src="plugins/greensock/TimelineMax.min.js"></script>
	<script src="plugins/scrollmagic/ScrollMagic.min.js"></script>
	<script src="plugins/greensock/animation.gsap.min.js"></script>
	<script src="plugins/greensock/ScrollToPlugin.min.js"></script>
	<script src="plugins/OwlCarousel2-2.2.1/owl.carousel.js"></script>
	<script src="plugins/easing/easing.js"></script>
	<script src="plugins/parallax-js-master/parallax.min.js"></script>
	<script src="plugins/Isotope/isotope.pkgd.min.js"></script>
	<script src="plugins/Isotope/fitcolumns.js"></script>
	<script src="js/custom.js"></script>


    <script src="zhouranJS/ajax.js"></script>
    <script src="zhouranJS/calculator.js"></script>


</body>
<script>
    $(function () {
        getJSON("/goods/index",{},callback_index);
    });


    function callback_index(result) {
        console.log(result);
        //构建类型
        build_goodType(result);
        //构建商品列表
        build_goodList(result);

    }


    //展示商品类别列表
    function build_goodType(result) {
        let type = result.extend.type;
        let content = "";
        $.each(type,function (i,obj) {
            content+="<div class='col-lg-4 box_col'>" +
                "   <div class='box'>" +
                "    <div class=;box_image'>" +
                "           <img src='"+obj.timage+"' alt='"+obj.tname+"'>" +
                "   </div>" +
                "       <div class='box_title trans_200'>" +
                "           <a href='javascript:;' onclick='queryGoodsByTypeId("+obj.tid+")'>"+obj.tname+"</a>" +
                "       </div>" +
                "   </div>" +
                "</div>";
        });
        $("#type_div").empty().append(content)

    }

    //构建商品列表
    function build_goodList(result) {
        let list = result.extend.list;
        let content = "";
        $.each(list,function (i,obj) {

            let mark = "";
            if(obj.glabel===1){
                mark = "new";
            }else if (obj.glabel===2) {
                mark="hot";
            }else if(obj.glabel===3){
                mark="sale";
            }

            content+="<div class='product grid-item "+mark+"'>" +
                "<div class='product_inner'>" +
                "<a style='cursor: pointer' onclick='queryGoodsDetail("+obj.gid+")'>" +
                "<div class='product_image'>" +
                "   <img src='"+obj.gimage+"' alt=''>" +
                "<div class='product_tag'>"+mark+"</div>" +
                "</div>" +
                "<div class='product_content text-center'>" +
                "<div class='product_title'>" + obj.gname+"</a>" +
                "</div>" +
                "<div class='product_price'>" +
                "￥" + obj.gprice.cheng(obj.gdiscount).toFixed(2);
                if(obj.glabel===3){
                    content+="<label style='color:black;'><s>"+obj.gprice+"</s></label>";
                }
                content+="</div>" +
                    "<div class='product_button ml-auto mr-auto trans_200'>" +
                    "<a href='javascript:void(0);' class='addshopcar' gid='"+obj.gid+"'>加入购物车</a>"+
                    "</div></div></div></div>"

        });

       $("#goodlist_div").empty().append(content);
    }


    /**
     * 点击类型跳转页面
     * @param typeid
     */
    function queryGoodsByTypeId(typeid) {
        alert("根据类型查询商品:typeid = "+typeid);
        location.href="prolist.html?typeid="+typeid
    }

    /**
     * 点击商品详情
     * @param goodid
     */
    function queryGoodsDetail(goodid) {
        alert("商品id:goodid = "+goodid);
    }

    /**
     * 点击类型（爆款
     * @param glabelid
     */
    function queryByGLabel(glabelid) {
        getJSON("/goods/index",{glabel:glabelid},callback_index)
    }

</script>




</html>